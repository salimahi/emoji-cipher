<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Emoji Cipher™ – Puzzle</title>
  <meta name="description" content="Emoji Cipher™ is an original logic puzzle by Salimah Ismail. Decode the emojis to reveal the hidden phrase and balance the equations.">
  <meta name="author" content="Salimah Ismail">
  <meta name="copyright" content="© 2025 Salimah Ismail. Licensed under CC BY-NC-ND 4.0 International.">
  <meta name="license" content="https://creativecommons.org/licenses/by-nc-nd/4.0/">
  <style>
    body {
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;
      margin: 2rem auto;
      max-width: 640px;
      line-height: 1.5;
      color: #222;
      background: #fdfdfd;
    }
    h1, h2 { text-align: center; }
    .note-box {
      background: #fff8db;
      border: 1px solid #e6d78a;
      border-radius: .5rem;
      padding: .75rem;
      margin-bottom: 1rem;
      font-size: .9rem;
    }
    .cipher-phrase-emoji {
      font-size:1.5rem;
      background:#fff;
      border:1px solid #ddd;
      border-radius:.5rem;
      padding:.75rem 1rem;
      display:flex;
      flex-wrap:wrap;
      gap:.5rem .6rem;
      box-shadow:0 1px 2px rgb(0 0 0 / .05);
    }
    .phrase-box {
      font-size:1.25rem;
      font-weight:600;
      letter-spacing:.05em;
      background:#fff;
      border:1px solid #ddd;
      border-radius:.5rem;
      padding:1rem;
      min-height:3rem;
      box-shadow:0 2px 4px rgb(0 0 0 / .06) inset;
      word-wrap:break-word;
      white-space:pre-wrap;
    }
    .mapping-row {
      display:grid;
      grid-template-columns:2rem 1fr 1fr;
      align-items:center;
      gap:.5rem;
      padding:.5rem .75rem;
      border:1px solid #ddd;
      border-radius:.5rem;
      background:#fafafa;
      margin-bottom:.5rem;
      box-shadow:0 1px 2px rgb(0 0 0 / .05);
    }
    .emoji-cell{font-size:1.5rem;text-align:center;}
    label{display:block;font-size:.7rem;font-weight:500;color:#555;margin-bottom:.25rem;}
    input[type="text"],input[type="number"]{
      width:100%;
      font-size:1rem;
      padding:.4rem .5rem;
      border:1px solid #bbb;
      border-radius:.4rem;
      font-family:inherit;
      background:white;
    }
    input:focus{border-color:#000;outline:none;}
    .section-title{
      font-size:1rem;
      font-weight:600;
      margin:1.5rem 0 .5rem;
      text-transform:uppercase;
      letter-spacing:.03em;
      color:#444;
    }
    .equations-wrapper{
      border:1px solid #ddd;
      border-radius:.5rem;
      background:#fff;
      box-shadow:0 1px 2px rgb(0 0 0 / .05);
    }
    .equation-row{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:1rem;
      padding:.75rem .75rem;
      border-bottom:1px solid #eee;
      font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;
      font-size:.9rem;
      line-height:1.3;
    }
    .equation-row:last-child{border-bottom:none;}
    .eq-right{text-align:right;min-width:7rem;font-weight:500;}
    .status-ok{color:#108a00;}
    .status-bad{color:#b00020;}
    .win-box{
      margin-top:1rem;
      border-radius:.75rem;
      padding:1rem;
      font-weight:600;
      text-align:center;
      font-size:1rem;
      display:none;
      background:#e6ffe6;
      border:2px solid #108a00;
      color:#0a4f00;
      box-shadow:0 4px 10px rgb(0 0 0 / .08);
    }
    footer{
      margin-top:2rem;
      font-size:.8rem;
      text-align:center;
      color:#666;
    }
    footer a{
      color:#555;
      text-decoration:none;
    }
  </style>
</head>
<body>
  <h1>Emoji Cipher™</h1>
  <h2>Puzzle</h2>

  <div class="note-box">
    Each emoji stands for <strong>one letter</strong> and <strong>one number</strong>.<br>
    Decode the secret phrase <em>and</em> make all the equations true.
  </div>

  <div class="section-title">Secret Phrase (in emojis)</div>
  <div class="cipher-phrase-emoji" id="emojiPhraseDisplay"></div>

  <div class="section-title">Check the Math</div>
  <div class="equations-wrapper" id="equationsArea"></div>

  <div class="section-title">Your Decoded Phrase</div>
  <div class="phrase-box" id="decodedPreview">_ _ _</div>

  <div class="section-title">Assign Letters and Numbers</div>
  <div id="mappingInputs"></div>

  <div class="win-box" id="winBox">
    ✅ You solved it!
  </div>

  <footer>
    Emoji Cipher™ © 2025 Salimah Ismail.<br>
    Licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0 International</a>.
  </footer>

  <script>
  (function(){

    // PUZZLES ARRAY: All 10 levels
    const PUZZLES = [
      // 1. COOL GAME BRO
      {
        phrase: "COOL GAME BRO",
        phraseEmojis: [
          "🦊","🪐","🪐","🐸","⬜",
          "🚀","🌵","🎲","🔮","⬜",
          "🧊","🌵","🪐"
        ],
        uniqueEmojis: ["🦊","🪐","🐸","🚀","🌵","🎲","🔮","🧊"],
        // numbers:
        // 🦊 C=3, 🪐 O=8, 🐸 L=4, 🚀 G=7,
        // 🌵 A=1, 🎲 M=6, 🔮 E=2, 🧊 B=5, (R uses 🌵? we reused A here, that's ok for level 1 simplicity)
        equations: [
          { left:["🦊","+","🪐"], target:11 },          //3+8
          { left:["🪐","+","🐸"], target:12 },          //8+4
          { left:["🚀","+","🌵","+","🎲"], target:14 }, //7+1+6
          { left:["🎲","+","🔮"], target:8 },          //6+2
          { left:["🧊","+","🌵"], target:6 }           //5+1
        ]
      },

      // 2. IT IS NAP TIME
      {
        phrase: "IT IS NAP TIME",
        phraseEmojis: [
          "🍄","🧊","⬜",
          "🍄","🐸","⬜",
          "🐙","🌵","🦊","⬜",
          "🧊","🍄","🎲","🔮"
        ],
        uniqueEmojis: ["🍄","🧊","🐸","🐙","🌵","🦊","🎲","🔮"],
        // 🍄 I=4, 🧊 T=9, 🐸 S=2, 🐙 N=5,
        // 🌵 A=1, 🦊 P=7, 🎲 M=6, 🔮 E=3
        equations: [
          { left:["🍄","+","🧊"], target:13 },   //4+9
          { left:["🐸","+","🐙"], target:7 },    //2+5
          { left:["🌵","+","🦊"], target:8 },    //1+7
          { left:["🎲","+","🔮"], target:9 },    //6+3
          { left:["🧊","+","🎲"], target:15 }    //9+6
        ]
      },

      // 3. HERBAL OR VERBAL TEA
      {
        phrase: "HERBAL OR VERBAL TEA",
        phraseEmojis: [
          "🪐","🔮","🌊","🚀","🌵","🐙","⬜",
          "🎲","🌊","⬜",
          "🦊","🔮","🌊","🚀","🌵","🐙","⬜",
          "🧊","🔮","🌵"
        ],
        uniqueEmojis: ["🪐","🔮","🌊","🚀","🌵","🐙","🎲","🦊","🧊"],
        // 🪐 H=4, 🔮 E=2, 🌊 R=9, 🚀 B=5,
        // 🌵 A=1, 🐙 L=7, 🎲 O=6, 🦊 V=8, 🧊 T=3
        equations: [
          { left:["🪐","+","🔮"], target:6 },        //4+2
          { left:["🌊","+","🚀"], target:14 },       //9+5
          { left:["🌵","+","🐙"], target:8 },        //1+7
          { left:["🎲","+","🌊"], target:15 },       //6+9
          { left:["🦊","+","🔮"], target:10 },       //8+2
          { left:["🧊","+","🔮","+","🌵"], target:6 } //3+2+1
        ]
      },

      // 4. ADDICTED TO RAGEAHOL
      {
        phrase: "ADDICTED TO RAGEAHOL",
        phraseEmojis: [
          "🌵","🎲","🎲","🍄","🦊","🧊","🔮","🎲","⬜",
          "🧊","🎲","⬜",
          "🌊","🌵","🚀","🔮","🌵","🐸","🎲","🐙"
        ],
        uniqueEmojis: ["🌵","🎲","🍄","🦊","🧊","🔮","🌊","🚀","🐸","🐙"],
        // 🌵 A=1, 🎲 D=7, 🍄 I=4, 🦊 C=8,
        // 🧊 T=9, 🔮 E=3, 🌊 R=5, 🚀 G=2,
        // 🐸 H=4, 🐙 L=8 (reuse nums allowed)
        equations: [
          { left:["🌵","+","🎲"], target:8 },        //1+7
          { left:["🎲","+","🍄"], target:11 },       //7+4
          { left:["🦊","+","🧊"], target:17 },       //8+9
          { left:["🔮","+","🎲"], target:10 },       //3+7
          { left:["🌊","+","🌵","+","🚀"], target:8 },//5+1+2
          { left:["🐸","+","🎲"], target:11 },       //4+7
          { left:["🎲","+","🐙"], target:15 }        //7+8
        ]
      },

      // 5. I BARELY EVEN KNOW HER
      {
        phrase: "I BARELY EVEN KNOW HER",
        phraseEmojis: [
          "🍄","⬜",
          "🚀","🌵","🌊","🔮","🐙","🧊","⬜",
          "🔮","🎲","🔮","🐙","⬜",
          "🧊","🐙","🎲","🪐","⬜",
          "🐸","🔮","🌊"
        ],
        uniqueEmojis: ["🍄","🚀","🌵","🌊","🔮","🐙","🧊","🎲","🪐","🐸"],
        // 🍄 I=4, 🚀 B=6, 🌵 A=1, 🌊 R=9,
        // 🔮 E=2, 🐙 L=7, 🧊 Y=8,
        // 🎲 V=5, 🪐 N=3, 🐸 K=4
        equations: [
          { left:["🍄","+","🚀"], target:10 },       //4+6
          { left:["🌵","+","🌊"], target:10 },       //1+9
          { left:["🔮","+","🐙","+","🧊"], target:17 }, //2+7+8
          { left:["🔮","+","🎲"], target:7 },        //2+5
          { left:["🎲","+","🪐"], target:8 },        //5+3
          { left:["🐸","+","🔮"], target:6 }         //4+2
        ]
      },

      // 6. SEND MORE KITTENS
      {
        phrase: "SEND MORE KITTENS",
        phraseEmojis: [
          "🦊","🐸","🪐","🎲","⬜",
          "🚀","🔮","🌵","🐸","⬜",
          "🧊","🐙","🦴","🦴","🐸","🪼","🐍"
        ],
        uniqueEmojis: ["🦊","🐸","🪐","🎲","🚀","🔮","🌵","🧊","🐙","🦴","🪼","🐍"],
        // 🦊 S=6, 🐸 E=2, 🪐 N=5, 🎲 D=4,
        // 🚀 M=7, 🔮 O=8, 🌵 R=3,
        // 🧊 K=9, 🐙 I=1, 🦴 T=4,
        // 🪼 N=5, 🐍 S=6
        equations: [
          { left:["🦊","+","🐸"], target:8 },             //6+2
          { left:["🐸","+","🪐","+","🎲"], target:11 },   //2+5+4
          { left:["🚀","+","🔮"], target:15 },           //7+8
          { left:["🌵","+","🐸"], target:5 },            //3+2
          { left:["🧊","+","🐙"], target:10 },           //9+1
          { left:["🦴","+","🦴"], target:8 },            //4+4
          { left:["🐸","+","🪼","+","🐍"], target:13 }    //2+5+6
        ]
      },

      // 7. CAUGHT A VIBE
      {
        phrase: "CAUGHT A VIBE",
        phraseEmojis: [
          "🌵","🐙","🚀","🦊","🐸","🧊","⬜",
          "🐙","⬜",
          "🎲","🔮","🪐","🦴"
        ],
        uniqueEmojis: ["🌵","🐙","🚀","🦊","🐸","🧊","🎲","🔮","🪐","🦴"],
        // 🌵 C=2, 🐙 A=1, 🚀 U=6, 🦊 G=7,
        // 🐸 H=4, 🧊 T=9,
        // 🎲 V=8, 🔮 I=3, 🪐 B=5, 🦴 E=2
        equations: [
          { left:["🌵","+","🐙"], target:3 },      //2+1
          { left:["🚀","+","🦊"], target:13 },     //6+7
          { left:["🐸","+","🧊"], target:13 },     //4+9
          { left:["🎲","+","🔮"], target:11 },     //8+3
          { left:["🪐","+","🦴"], target:7 },      //5+2
          { left:["🐙","+","🎲"], target:9 }       //1+8
        ]
      },

      // 8. A CENTER FOR ANTS
      {
        phrase: "A CENTER FOR ANTS",
        phraseEmojis: [
          "🐙","⬜",
          "🧊","🌵","🦴","🔮","🌵","🎲","⬜",
          "🪐","🐸","🎲","⬜",
          "🐙","🦴","🔮","🚀"
        ],
        uniqueEmojis: ["🐙","🧊","🌵","🦴","🔮","🎲","🪐","🐸","🚀"],
        // 🐙 A=1, 🧊 C=6, 🌵 E=2, 🦴 N=5,
        // 🔮 T=9, 🎲 R=4, 🪐 F=7,
        // 🐸 O=8, 🚀 S=3
        equations: [
          { left:["🧊","+","🌵"], target:8 },           //6+2
          { left:["🦴","+","🔮"], target:14 },         //5+9
          { left:["🌵","+","🎲"], target:6 },          //2+4
          { left:["🪐","+","🐸"], target:15 },         //7+8
          { left:["🎲","+","🐙"], target:5 },          //4+1
          { left:["🐙","+","🦴","+","🔮","+","🚀"], target:18 } //1+5+9+3
        ]
      },

      // 9. BY DOG I MEAN SON
      {
        phrase: "BY DOG I MEAN SON",
        phraseEmojis: [
          "🧊","🎲","⬜",
          "🐸","🪐","🦊","⬜",
          "🍄","⬜",
          "🚀","🌵","🪼","🔮","⬜",
          "🐙","🪐","🔮"
        ],
        uniqueEmojis: ["🧊","🎲","🐸","🪐","🦊","🍄","🚀","🌵","🪼","🔮","🐙"],
        // 🧊 B=4, 🎲 Y=7, 🐸 D=8, 🪐 O=6,
        // 🦊 G=5, 🍄 I=3, 🚀 M=9, 🌵 E=2,
        // 🪼 A=1, 🔮 N=4, 🐙 S=6
        equations: [
          { left:["🧊","+","🎲"], target:11 },        //4+7
          { left:["🐸","+","🪐"], target:14 },        //8+6
          { left:["🦊","+","🍄"], target:8 },         //5+3
          { left:["🚀","+","🌵"], target:11 },        //9+2
          { left:["🪼","+","🔮"], target:5 },         //1+4
          { left:["🐙","+","🪐","+","🔮"], target:16 } //6+6+4
        ]
      },

      // 10. GREAT WORK SO FAR
      {
        phrase: "GREAT WORK SO FAR",
        phraseEmojis: [
          "🦊","🌵","🧊","🎲","🔮","⬜",
          "🚀","🐸","🌵","🦴","⬜",
          "🐙","🐸","⬜",
          "🍄","🎲","🌵"
        ],
        uniqueEmojis: ["🦊","🌵","🧊","🎲","🔮","🚀","🐸","🦴","🐙","🍄"],
        // 🦊 G=8, 🌵 R=4, 🧊 E=2, 🎲 A=1,
        // 🔮 T=9, 🚀 W=6, 🐸 O=7,
        // 🦴 K=5, 🐙 S=3, 🍄 F=4
        equations: [
          { left:["🦊","+","🌵"], target:12 },        //8+4
          { left:["🧊","+","🎲"], target:3 },         //2+1
          { left:["🔮","+","🚀"], target:15 },        //9+6
          { left:["🐸","+","🌵"], target:11 },        //7+4
          { left:["🦴","+","🐙"], target:8 },         //5+3
          { left:["🍄","+","🎲","+","🌵"], target:9 }  //4+1+4
        ]
      }
    ];

    // Pick a random puzzle from all 10
    const currentPuzzle = PUZZLES[Math.floor(Math.random() * PUZZLES.length)];

    // Track player's guesses
    const playerState = {};
    currentPuzzle.uniqueEmojis.forEach(e=>{
      playerState[e] = { letter:"", number:"" };
    });

    // DOM references
    const phraseDisplay   = document.getElementById("emojiPhraseDisplay");
    const equationsArea   = document.getElementById("equationsArea");
    const previewBox      = document.getElementById("decodedPreview");
    const mappingContainer= document.getElementById("mappingInputs");
    const winBox          = document.getElementById("winBox");

    function renderEmojiPhrase(){
      phraseDisplay.innerHTML = "";
      currentPuzzle.phraseEmojis.forEach(em=>{
        const span=document.createElement("span");
        span.textContent=em;
        phraseDisplay.appendChild(span);
      });
    }

    function renderMappingInputs(){
      mappingContainer.innerHTML = "";
      currentPuzzle.uniqueEmojis.forEach(em=>{
        const row=document.createElement("div");
        row.className="mapping-row";

        const emojiCell=document.createElement("div");
        emojiCell.className="emoji-cell";
        emojiCell.textContent=em;
        row.appendChild(emojiCell);

        const letterWrap=document.createElement("div");
        const letterLabel=document.createElement("label");
        letterLabel.textContent="Letter";
        const letterInput=document.createElement("input");
        letterInput.type="text";
        letterInput.maxLength=1;
        letterInput.dataset.emoji=em;
        letterInput.dataset.field="letter";
        letterInput.addEventListener("input",handleInputChange);
        letterWrap.appendChild(letterLabel);
        letterWrap.appendChild(letterInput);

        const numWrap=document.createElement("div");
        const numLabel=document.createElement("label");
        numLabel.textContent="Number (0-9)";
        const numInput=document.createElement("input");
        numInput.type="number";
        numInput.min="0";
        numInput.max="9";
        numInput.dataset.emoji=em;
        numInput.dataset.field="number";
        numInput.addEventListener("input",handleInputChange);
        numWrap.appendChild(numLabel);
        numWrap.appendChild(numInput);

        row.appendChild(letterWrap);
        row.appendChild(numWrap);

        mappingContainer.appendChild(row);
      });
    }

    function handleInputChange(e){
      const em = e.target.dataset.emoji;
      const field = e.target.dataset.field;
      let val = e.target.value;

      if(field==="letter"){
        val = val.toUpperCase().replace(/[^A-Z ]/g,"").slice(0,1);
        e.target.value = val;
      }

      if(field==="number"){
        if(val!==""){
          let n=parseInt(val,10);
          if(isNaN(n)) n="";
          if(n<0) n=0;
          if(n>9) n=9;
          e.target.value = n;
          val = e.target.value;
        }
      }

      playerState[em][field] = val;
      update();
    }

    function buildPreviewString(){
      let out = "";
      currentPuzzle.phraseEmojis.forEach(em=>{
        if(em==="⬜"){
          out += " ";
        } else {
          const guess = playerState[em]?.letter || "";
          out += guess ? guess : "_";
        }
      });
      return out;
    }

    function renderPreview(){
      previewBox.textContent = buildPreviewString();
    }

    function evaluateEquation(eqObj){
      let pieces = [];
      let valid  = true;

      eqObj.left.forEach(token=>{
        if(token==="+"){
          pieces.push("+");
        } else {
          const guessNum = playerState[token]?.number;
          if(!guessNum && guessNum!==0){
            pieces.push("?");
            valid = false;
          } else {
            pieces.push(String(guessNum));
          }
        }
      });

      let computed = null;
      if(valid){
        computed = 0;
        pieces.forEach(p=>{
          if(p!=="+"){
            const n = parseInt(p,10);
            if(isNaN(n)){
              valid=false;
            } else {
              computed += n;
            }
          }
        });
        if(computed !== eqObj.target){
          valid = false;
        }
      }

      const displayStr = pieces.join(" ")+" = "+eqObj.target+" "+(valid?"✅":"❌");
      return {
        html: "<span class='"+(valid?"status-ok":"status-bad")+"'>"+displayStr+"</span>",
        ok: valid
      };
    }

    function renderEquations(){
      equationsArea.innerHTML = "";
      currentPuzzle.equations.forEach(eq=>{
        const row=document.createElement("div");
        row.className="equation-row";

        const left=document.createElement("div");
        left.textContent = eq.left.join(" ")+" = "+eq.target;

        const right=document.createElement("div");
        right.className="eq-right";
        const res=evaluateEquation(eq);
        right.innerHTML = res.html;

        row.appendChild(left);
        row.appendChild(right);
        equationsArea.appendChild(row);
      });
    }

    function checkWin(){
      const solvedPhrase = buildPreviewString() === currentPuzzle.phrase;
      let allEqOk = true;
      for(const eq of currentPuzzle.equations){
        if(!evaluateEquation(eq).ok){
          allEqOk = false;
          break;
        }
      }
      if(solvedPhrase && allEqOk){
        winBox.style.display = "block";
      } else {
        winBox.style.display = "none";
      }
    }

    function update(){
      renderPreview();
      renderEquations();
      checkWin();
    }

    function init(){
      renderEmojiPhrase();
      renderMappingInputs();
      update();
    }

    init();

  })();
  </script>
</body>
</html>
